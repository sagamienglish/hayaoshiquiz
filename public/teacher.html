<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>教員用スタート画面</title>
<style>
  body { 
    font-family: sans-serif; 
    padding: 20px; 
    background-color: #f0f2f5; 
  }
  .container { 
    background: white; 
    padding: 24px; 
    border-radius: 8px; 
    box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
    max-width: 600px; 
    position: relative; /* 設定ボタンの配置基準 */
  }
  .section { 
    margin-bottom: 24px; 
  }
  
  /* トップ画面のヘッダー部分 */
  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 2px solid #eee;
    padding-bottom: 12px;
    margin-bottom: 20px;
  }
  .header h2 { margin: 0; }
  
  /* 設定ボタン */
  .btn-settings {
    background-color: #4CAF50;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
  }
  .btn-settings:hover { background-color: #45a049; }

  /* スコア設定（コンパクト） */
  .score-settings { 
    display: flex; 
    align-items: center; 
    gap: 16px; 
    background: #f9f9f9;
    padding: 12px;
    border-radius: 4px;
    border: 1px solid #e0e0e0;
  }
  .score-settings label { margin: 0; }
  .score-settings input { width: 60px; padding: 4px; margin-left: 4px; }
  
  /* QRコード */
  .qr-thumbnail { 
    width: 120px; 
    cursor: pointer; 
    border: 1px solid #ddd; 
    border-radius: 4px;
    transition: 0.2s; 
  }
  .qr-thumbnail:hover { opacity: 0.8; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
  
  /* モーダル共通設定（QR用＆設定用） */
  .modal-overlay { 
    display: none; 
    position: fixed; 
    top: 0; left: 0; 
    width: 100%; height: 100%; 
    background: rgba(0,0,0,0.6); 
    justify-content: center; 
    align-items: center; 
    z-index: 1000; 
  }
  .modal-overlay.active { display: flex; }
  
  /* 設定用モーダルの中身 */
  .settings-modal {
    background: white;
    padding: 24px;
    border-radius: 8px;
    width: 90%;
    max-width: 700px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  }
  .settings-modal textarea {
    width: 100%;
    height: 200px;
    margin-top: 12px;
    padding: 8px;
    box-sizing: border-box;
    font-family: monospace;
    white-space: pre;
  }
  .btn-download {
    background-color: #2196F3;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 13px;
    margin-bottom: 8px;
  }
  .btn-download:hover { background-color: #1976D2; }
  .btn-close {
    background-color: #666;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    margin-top: 12px;
  }

  /* QR用モーダルの中身 */
  .qr-large { 
    width: 80vw; 
    max-width: 500px; 
    background: white; 
    padding: 20px; 
    border-radius: 8px; 
    cursor: pointer;
  }
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <h2>Lesson 1 Vocabulary</h2>
    <button class="btn-settings" onclick="toggleModal('settingsModal')">⚙️ 問題設定</button>
  </div>

  <div class="section">
    <label><b>モード設定:</b></label>
    <select disabled style="padding: 4px 8px; font-size: 16px;">
      <option selected>Quizのみ</option>
    </select>
  </div>

  <div class="section">
    <label><b>スコア設定:</b></label>
    <div class="score-settings">
      <label>配点: <input type="number" value="10"></label>
      <label>合格点: <input type="number" value="8"></label>
      <label>制限時間: <input type="number" value="60"> 秒</label>
    </div>
  </div>

  <div class="section">
    <label><b>生徒用アクセスQRコード:</b></label>
    <p style="font-size: 0.85em; color: #666; margin-top: 4px;">（画像をクリックすると拡大表示されます）</p>
    <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=ExampleData" class="qr-thumbnail" onclick="toggleModal('qrModal')" alt="縮小版QRコード">
  </div>
</div>

<div class="modal-overlay" id="settingsModal">
  <div class="settings-modal">
    <h3>問題データの登録</h3>
    <p style="font-size: 0.9em; color: #555;">
      Excel等から「問題・選択肢1〜4・正解番号」の順に並んだデータをコピーし、下の枠に貼り付けてください。
    </p>
    
    <button class="btn-download" onclick="downloadTemplate()">⬇️ Excel用テンプレート(CSV)をダウンロード</button>
    
    <textarea id="quizData" placeholder="例:&#10;apple&#9;りんご&#9;みかん&#9;ばなな&#9;ぶどう&#9;1&#10;grape&#9;りんご&#9;みかん&#9;ばなな&#9;ぶどう&#9;4"></textarea>
    
    <div style="text-align: right;">
      <button class="btn-close" onclick="toggleModal('settingsModal')">保存して閉じる</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="qrModal" onclick="toggleModal('qrModal')">
  <img src="https://api.qrserver.com/v1/create-qr-code/?size=500x500&data=ExampleData" class="qr-large" alt="拡大版QRコード">
  <p style="color: white; position: absolute; bottom: 10%; font-size: 1.2em; pointer-events: none;">クリックで元に戻る</p>
</div>

<script>
  // モーダルの開閉を管理する関数
  function toggleModal(modalId) {
    const modal = document.getElementById(modalId);
    modal.classList.toggle('active');
  }

  // CSVテンプレートを動的に生成してダウンロードさせる関数
  function downloadTemplate() {
    // 先生が使いやすいように、英語の語彙テストを想定したダミーデータを入力しています
    const csvHeader = "問題,選択肢1,選択肢2,選択肢3,選択肢4,正解番号\n";
    const sampleData = "apple,りんご,みかん,ばなな,ぶどう,1\nbeautiful,美しい,悲しい,大きい,小さい,1\n";
    
    // Excelで文字化けしないようにBOM（Byte Order Mark）を付与
    const bom = new Uint8Array([0xEF, 0xBB, 0xBF]);
    const blob = new Blob([bom, csvHeader + sampleData], { type: 'text/csv;charset=utf-8;' });
    
    const url = URL.createObjectURL(blob);
    const link = document.createElement("a");
    link.href = url;
    link.download = "QuizTemplate.csv"; // ダウンロードされるファイル名
    
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }
</script>

</body>
</html>
